CREATE VIEW v1 AS
SELECT SSN, FName, LName, PName, P.DNum, D.DNumber, D.DName
FROM Employee E JOIN Works_On W ON E.SSN = W.ESSN
JOIN Project P ON W.PNum = P.PNumber AND E.DNum = P.DNum
JOIN Department D ON P.DNum = D.DNumber
ORDER BY P.PName;


CREATE VIEW v1 AS
SELECT SSN, FName,LName, DNum
FROM Employee;
CREATE VIEW
SELECT * FROM v1;

//LATIHAN//
1a.
CREATE VIEW d1 AS
SELECT SSN, FNAME,LNAME, P.PNAME
FROM Employee E JOIN DEPARTMENT D ON E.SSN = D.MGRSSN
JOIN Works_On W ON D.MGRSSN = W.ESSN
JOIN Project P ON W.PNum = P.PNumber

SELECT * FROM d1;

2a.
CREATE VIEW d3 (Nomor,Nama) AS
SELECT DNumber, DName
FROM Department;

2b.
CREATE VIEW d4 AS
SELECT SSN, CONCAT (FName,' ',LName) AS EName,DName
FROM Employee E, Department D, Works_On W
WHERE E.DNum = D.DNumber AND W.hours > 140
order by E.ssn;

1b.
CREATE VIEW d6 AS
SELECT ESSN, FName, LName, Dependent_Name, Relationship
FROM Works_On
Group by Pnum


